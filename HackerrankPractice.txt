-- Revising Aggregations - The Count Function

select distinct count (*) from CITY where POPULATION > 100000;

select sum(POPULATION) from CITY where DISTRICT = 'California';

select avg(POPULATION) from CITY where DISTRICT = 'California';

select round(avg(POPULATION)) from CITY;

select sum(POPULATION) from CITY where COUNTRYCODE = 'JPN';

select max(POPULATION) - min(POPULATION) as DIFF from CITY;

select * from CITY where COUNTRYCODE = 'USA' and POPULATION > 100000;

-- THE PADS Challenge

select concat(concat(NAME,'('),concat(SUBSTR(OCCUPATION,1,1),')')) as NAME from OCCUPATIONS  order by NAME;
select 'There are a total of ',count(*) as C,concat(lower(OCCUPATION),'s.') as OCTOTAL from OCCUPATIONS group by OCCUPATION order by C, OCTOTAL ; 


-- Weather observation

select round(sum(lat_n),2) as lat, round(sum(long_w),2) as lon from STATION;

select round(sum(lat_n),4) from STATION where lat_n between 38.788 and 137.2345;

select round(max(lat_n),4) from STATION where lat_n < 137.2345;

select round(long_w,4) from STATION where lat_n = (select max(lat_n) from STATION where lat_n< 137.2345);